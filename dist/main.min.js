(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({"/Users/erikrekola/Awesome/GrannySlalom/src/js/entities/gramma.js":[function(require,module,exports){
var Gramma = function (game, x, y) {
    Phaser.Sprite.call(this, game, x, y, 'gramma');
    game.add.existing(this);
    game.physics.enable(this, Phaser.Physics.ARCADE);
    this.anchor.setTo(0.5, 0.5);
    this.scale.set(2);
    this.smoothed = false;
    this.animations.add('run');
    this.animations.play('run', 10, true);
    this.body.bounce.setTo(1, 1);
    this.body.setSize(12, 10, 4, 26);
    this.body.mass = .5;
    this.body.collideWorldBounds = false;
    this.checkWorldBounds = true;
    this.direction = Math.round(Math.random() * 1);
}

Gramma.prototype = Object.create(Phaser.Sprite.prototype);
Gramma.prototype.constructor = Gramma;

/**
 * Automatically called by World.update
 */
Gramma.prototype.update = function () {

    // Add speed to gramma
    this.body.velocity.y = Math.random() * 100;

    if (this.direction == 1) {
        this.body.velocity.x = Math.random() * 10;
    } else {
        this.body.velocity.x = Math.random() * -10;
    }

    // Remove the gramma when it leaves the screen
    if (this.position.y < this.game.camera.y) {
        this.kill();
    }
};

module.exports = Gramma;

},{}],"/Users/erikrekola/Awesome/GrannySlalom/src/js/entities/player.js":[function(require,module,exports){
var Player = function (game, x, y) {
    Phaser.Sprite.call(this, game, x, y, 'runner');
    game.add.existing(this);
    game.physics.enable(this, Phaser.Physics.ARCADE);
    this.anchor.setTo(0.5, 0.5);
    this.scale.set(2);
    this.smoothed = false;
    this.animations.add('run');
    this.animations.play('run', 10, true);
    this.body.bounce.setTo(0, 0);
    this.body.setSize(18, 10, 3, 26);
    this.body.maxVelocity = new Phaser.Point(1000, 1000);
    this.body.collideWorldBounds = true;
    this.mass = 2;
};

Player.prototype = Object.create(Phaser.Sprite.prototype);
Player.prototype.constructor = Player;

/**
 * Automatically called by World.update
 */
Player.prototype.update = function () {

    // Add speed to runner
    if (this.body.velocity.x == 0) {
        this.body.velocity.y += 1;
    }
};

module.exports = Player;

},{}],"/Users/erikrekola/Awesome/GrannySlalom/src/js/main.js":[function(require,module,exports){
'use strict';

var game = new Phaser.Game(360, 640, Phaser.AUTO, 'grannyslalom-game');

window.Utils = require('./utils');
window.playerState = {
    currentLevel: 'Game',
    scores:[]
}

game.state.add('Boot', require('./states/boot'));
game.state.add('Splash', require('./states/splash'));
game.state.add('Preloader', require('./states/preloader'));
game.state.add('Menu', require('./states/menu'));
game.state.add('Game', require('./states/game'));
game.state.add('Score', require('./states/score'));
game.state.add('Win', require('./states/win'));
game.state.add('Lose', require('./states/lose'));

game.state.start('Boot');

},{"./states/boot":"/Users/erikrekola/Awesome/GrannySlalom/src/js/states/boot.js","./states/game":"/Users/erikrekola/Awesome/GrannySlalom/src/js/states/game.js","./states/lose":"/Users/erikrekola/Awesome/GrannySlalom/src/js/states/lose.js","./states/menu":"/Users/erikrekola/Awesome/GrannySlalom/src/js/states/menu.js","./states/preloader":"/Users/erikrekola/Awesome/GrannySlalom/src/js/states/preloader.js","./states/score":"/Users/erikrekola/Awesome/GrannySlalom/src/js/states/score.js","./states/splash":"/Users/erikrekola/Awesome/GrannySlalom/src/js/states/splash.js","./states/win":"/Users/erikrekola/Awesome/GrannySlalom/src/js/states/win.js","./utils":"/Users/erikrekola/Awesome/GrannySlalom/src/js/utils.js"}],"/Users/erikrekola/Awesome/GrannySlalom/src/js/states/boot.js":[function(require,module,exports){
var Boot = function () {
};

module.exports = Boot;

Boot.prototype = {

    preload: function () {
        this.load.image('preloader', 'assets/preloader.gif');
    },

    create: function () {
        this.game.input.maxPointers = 1;

        this.game.scale.scaleMode = Phaser.ScaleManager.SHOW_ALL;

        this.game.state.start('Preloader');
    }
};

},{}],"/Users/erikrekola/Awesome/GrannySlalom/src/js/states/game.js":[function(require,module,exports){
var Player = require('../entities/player');
var Gramma = require('../entities/gramma');

var Game = function () {
    this.runner = null;
    this.land = null;
    this.grammas = null;
    this.nextGramma = 640;
    this.timer = 0;
    this.stageLength = 60 * 300;
};

module.exports = Game;

Game.prototype = {

    create: function () {

        this.world.setBounds(0, 0, 360, this.stageLength);

        this.physics.startSystem(Phaser.Physics.ARCADE);

        this.land = this.add.tileSprite(0, 0, 360, 640, 'floortile');
        this.land.scale.set(2);
        this.land.smoothed = false;
        this.land.fixedToCamera = true;

        this.runner = new Player(this.game, 360/2, 200);
        this.grammas = this.add.group();

        this.camera.follow(this.runner);

        this.time.events.add(Phaser.Timer.SECOND * 60, this.endGame, this);

        this.timer = this.game.add.text(this.world.centerX, 0, "60");
        this.timer.fixedToCamera = true;
        this.timer.anchor.set(0.5, 0);
    },

    update: function () {

        var timeLeft = Math.floor(this.time.events.duration / 1000);
        var distanceLeft = this.stageLength - this.camera.y - 640;

        this.timer.setText(timeLeft + ' || ' + distanceLeft);

        this.physics.arcade.collide(this.runner, this.grammas);

        this.runner.body.velocity.x = 0;

        // Key press to right
        if (this.input.keyboard.isDown(Phaser.Keyboard.RIGHT)) {
            this.runner.body.velocity.x = + 300;
        }

        // Key press to left
        if (this.input.keyboard.isDown(Phaser.Keyboard.LEFT)) {
            this.runner.body.velocity.x = - 300;
        }


        // the ammount is halved due to scaling
        this.land.tilePosition.x = -this.camera.x / 2;
        this.land.tilePosition.y = -this.camera.y / 2;

        if (this.camera.y > this.nextGramma) {
            this.addGramma();
        }

        if (distanceLeft == 0) {
            this.endGame(true);
        }
    },

    render: function () {

        // this.game.debug.bodyInfo(this.runner, 32, 32);
        // this.game.debug.body(this.runner, 32, 32);

    },

    addGramma: function () {
        var gramma = new Gramma(
            this.game,
            this.runner.x + (90 - (Math.random() * 180)),
            this.camera.y + 640
        );

        // this.game.debug.body(gramma);
        this.grammas.add(gramma);
        this.nextGramma+= 640;
    },

    outBounds: function () {
        console.log('out');
        // this.endGame(true)
    },

    endGame: function (win) {
        var score = 0;

        if (win) {
            this.game.state.start('Win');
            score = this.time.events.duration;
            window.playerState.scores.push(score);
        } else {
            this.game.state.start('Lose');
        }
    }
};

},{"../entities/gramma":"/Users/erikrekola/Awesome/GrannySlalom/src/js/entities/gramma.js","../entities/player":"/Users/erikrekola/Awesome/GrannySlalom/src/js/entities/player.js"}],"/Users/erikrekola/Awesome/GrannySlalom/src/js/states/lose.js":[function(require,module,exports){
var Lose = function () {
};

module.exports = Lose;

Lose.prototype = {
    create: function () {
        var style = {font: "24px Arial", fill: "#ffffff", align: "center"},
            text = this.add.text(this.world.centerX, 200, "You Lose", style);

        text.anchor.set(0.5, 0);

        this.input.onDown.add(this.onDown, this);
    },

    onDown: function () {
        this.game.state.start('Menu');
    }
};
},{}],"/Users/erikrekola/Awesome/GrannySlalom/src/js/states/menu.js":[function(require,module,exports){
var Menu = function () {
    this.text = null;
};

module.exports = Menu;

Menu.prototype = {

    create: function () {
        var style = {font: "24px Arial", fill: "#ffffff", align: "center"},
            text = this.add.text(this.world.centerX, 200, "Press to Start", style);

        this.stage.backgroundColor = "#000000";

        text.anchor.set(0.5, 0);

        this.input.onDown.add(this.onDown, this);
    },

    update: function () {
    },

    onDown: function () {
        this.game.state.start(playerState.currentLevel);
        // this.game.state.start('Win');
    }
};

},{}],"/Users/erikrekola/Awesome/GrannySlalom/src/js/states/preloader.js":[function(require,module,exports){
var Preloader = function (game) {
    this.asset = null;
    this.ready = false;
};

module.exports = Preloader;

Preloader.prototype = {

    preload: function () {
        this.asset = this.add.sprite(320, 240, 'preloader');
        this.asset.anchor.setTo(0.5, 0.5);

        this.load.onLoadComplete.addOnce(this.onLoadComplete, this);
        this.load.setPreloadSprite(this.asset);
        this.load.image('floortile', 'assets/floortile.png');
        this.load.spritesheet('runner', 'assets/runner.png', 36, 36);
        this.load.spritesheet('gramma', 'assets/gramma.png', 36, 36);

    },

    create: function () {
        this.asset.cropEnabled = false;
    },

    update: function () {
        if (!!this.ready) {
            this.game.state.start('Menu');
        }
    },

    onLoadComplete: function () {
        this.ready = true;
    }
};

},{}],"/Users/erikrekola/Awesome/GrannySlalom/src/js/states/score.js":[function(require,module,exports){
var Score = function () {
};

module.exports = Score;

Score.prototype = {
    create: function () {

    }
};
},{}],"/Users/erikrekola/Awesome/GrannySlalom/src/js/states/splash.js":[function(require,module,exports){
var Splash = function () {
};

module.exports = Splash;

Splash.prototype = {
    create: function () {
    }
};
},{}],"/Users/erikrekola/Awesome/GrannySlalom/src/js/states/win.js":[function(require,module,exports){
var Win = function () {
};

module.exports = Win;

Win.prototype = {
    create: function () {
        var lastScore = window.playerState.scores[window.playerState.scores.length-1],
            style = {font: "24px Arial", fill: "#ffffff", align: "center"},
            text = this.add.text(this.world.centerX, 200, "You win " + lastScore, style);

        text.anchor.set(0.5, 0);

        this.input.onDown.add(this.onDown, this);
    },

    onDown: function () {
        this.game.state.start('Menu');
    }
};
},{}],"/Users/erikrekola/Awesome/GrannySlalom/src/js/utils.js":[function(require,module,exports){
var Utils = {
    containsObject: function (obj, list) {
        var i;
        for (i = 0; i < list.length; i++) {
            if (list[i] === obj) {
                return true;
            }
        }

        return false;
    }
};

module.exports = Utils;
},{}]},{},["/Users/erikrekola/Awesome/GrannySlalom/src/js/main.js"])
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5vZGVfbW9kdWxlcy9icm93c2VyLXBhY2svX3ByZWx1ZGUuanMiLCJzcmMvanMvZW50aXRpZXMvZ3JhbW1hLmpzIiwic3JjL2pzL2VudGl0aWVzL3BsYXllci5qcyIsInNyYy9qcy9tYWluLmpzIiwic3JjL2pzL3N0YXRlcy9ib290LmpzIiwic3JjL2pzL3N0YXRlcy9nYW1lLmpzIiwic3JjL2pzL3N0YXRlcy9sb3NlLmpzIiwic3JjL2pzL3N0YXRlcy9tZW51LmpzIiwic3JjL2pzL3N0YXRlcy9wcmVsb2FkZXIuanMiLCJzcmMvanMvc3RhdGVzL3Njb3JlLmpzIiwic3JjL2pzL3N0YXRlcy9zcGxhc2guanMiLCJzcmMvanMvc3RhdGVzL3dpbi5qcyIsInNyYy9qcy91dGlscy5qcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtBQ0FBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUN6Q0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUMvQkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3BCQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ25CQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDOUdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ2xCQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUMzQkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ25DQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNUQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDUkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNuQkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSIsImZpbGUiOiJnZW5lcmF0ZWQuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlc0NvbnRlbnQiOlsiKGZ1bmN0aW9uIGUodCxuLHIpe2Z1bmN0aW9uIHMobyx1KXtpZighbltvXSl7aWYoIXRbb10pe3ZhciBhPXR5cGVvZiByZXF1aXJlPT1cImZ1bmN0aW9uXCImJnJlcXVpcmU7aWYoIXUmJmEpcmV0dXJuIGEobywhMCk7aWYoaSlyZXR1cm4gaShvLCEwKTt2YXIgZj1uZXcgRXJyb3IoXCJDYW5ub3QgZmluZCBtb2R1bGUgJ1wiK28rXCInXCIpO3Rocm93IGYuY29kZT1cIk1PRFVMRV9OT1RfRk9VTkRcIixmfXZhciBsPW5bb109e2V4cG9ydHM6e319O3Rbb11bMF0uY2FsbChsLmV4cG9ydHMsZnVuY3Rpb24oZSl7dmFyIG49dFtvXVsxXVtlXTtyZXR1cm4gcyhuP246ZSl9LGwsbC5leHBvcnRzLGUsdCxuLHIpfXJldHVybiBuW29dLmV4cG9ydHN9dmFyIGk9dHlwZW9mIHJlcXVpcmU9PVwiZnVuY3Rpb25cIiYmcmVxdWlyZTtmb3IodmFyIG89MDtvPHIubGVuZ3RoO28rKylzKHJbb10pO3JldHVybiBzfSkiLCJ2YXIgR3JhbW1hID0gZnVuY3Rpb24gKGdhbWUsIHgsIHkpIHtcbiAgICBQaGFzZXIuU3ByaXRlLmNhbGwodGhpcywgZ2FtZSwgeCwgeSwgJ2dyYW1tYScpO1xuICAgIGdhbWUuYWRkLmV4aXN0aW5nKHRoaXMpO1xuICAgIGdhbWUucGh5c2ljcy5lbmFibGUodGhpcywgUGhhc2VyLlBoeXNpY3MuQVJDQURFKTtcbiAgICB0aGlzLmFuY2hvci5zZXRUbygwLjUsIDAuNSk7XG4gICAgdGhpcy5zY2FsZS5zZXQoMik7XG4gICAgdGhpcy5zbW9vdGhlZCA9IGZhbHNlO1xuICAgIHRoaXMuYW5pbWF0aW9ucy5hZGQoJ3J1bicpO1xuICAgIHRoaXMuYW5pbWF0aW9ucy5wbGF5KCdydW4nLCAxMCwgdHJ1ZSk7XG4gICAgdGhpcy5ib2R5LmJvdW5jZS5zZXRUbygxLCAxKTtcbiAgICB0aGlzLmJvZHkuc2V0U2l6ZSgxMiwgMTAsIDQsIDI2KTtcbiAgICB0aGlzLmJvZHkubWFzcyA9IC41O1xuICAgIHRoaXMuYm9keS5jb2xsaWRlV29ybGRCb3VuZHMgPSBmYWxzZTtcbiAgICB0aGlzLmNoZWNrV29ybGRCb3VuZHMgPSB0cnVlO1xuICAgIHRoaXMuZGlyZWN0aW9uID0gTWF0aC5yb3VuZChNYXRoLnJhbmRvbSgpICogMSk7XG59XG5cbkdyYW1tYS5wcm90b3R5cGUgPSBPYmplY3QuY3JlYXRlKFBoYXNlci5TcHJpdGUucHJvdG90eXBlKTtcbkdyYW1tYS5wcm90b3R5cGUuY29uc3RydWN0b3IgPSBHcmFtbWE7XG5cbi8qKlxuICogQXV0b21hdGljYWxseSBjYWxsZWQgYnkgV29ybGQudXBkYXRlXG4gKi9cbkdyYW1tYS5wcm90b3R5cGUudXBkYXRlID0gZnVuY3Rpb24gKCkge1xuXG4gICAgLy8gQWRkIHNwZWVkIHRvIGdyYW1tYVxuICAgIHRoaXMuYm9keS52ZWxvY2l0eS55ID0gTWF0aC5yYW5kb20oKSAqIDEwMDtcblxuICAgIGlmICh0aGlzLmRpcmVjdGlvbiA9PSAxKSB7XG4gICAgICAgIHRoaXMuYm9keS52ZWxvY2l0eS54ID0gTWF0aC5yYW5kb20oKSAqIDEwO1xuICAgIH0gZWxzZSB7XG4gICAgICAgIHRoaXMuYm9keS52ZWxvY2l0eS54ID0gTWF0aC5yYW5kb20oKSAqIC0xMDtcbiAgICB9XG5cbiAgICAvLyBSZW1vdmUgdGhlIGdyYW1tYSB3aGVuIGl0IGxlYXZlcyB0aGUgc2NyZWVuXG4gICAgaWYgKHRoaXMucG9zaXRpb24ueSA8IHRoaXMuZ2FtZS5jYW1lcmEueSkge1xuICAgICAgICB0aGlzLmtpbGwoKTtcbiAgICB9XG59O1xuXG5tb2R1bGUuZXhwb3J0cyA9IEdyYW1tYTtcbiIsInZhciBQbGF5ZXIgPSBmdW5jdGlvbiAoZ2FtZSwgeCwgeSkge1xuICAgIFBoYXNlci5TcHJpdGUuY2FsbCh0aGlzLCBnYW1lLCB4LCB5LCAncnVubmVyJyk7XG4gICAgZ2FtZS5hZGQuZXhpc3RpbmcodGhpcyk7XG4gICAgZ2FtZS5waHlzaWNzLmVuYWJsZSh0aGlzLCBQaGFzZXIuUGh5c2ljcy5BUkNBREUpO1xuICAgIHRoaXMuYW5jaG9yLnNldFRvKDAuNSwgMC41KTtcbiAgICB0aGlzLnNjYWxlLnNldCgyKTtcbiAgICB0aGlzLnNtb290aGVkID0gZmFsc2U7XG4gICAgdGhpcy5hbmltYXRpb25zLmFkZCgncnVuJyk7XG4gICAgdGhpcy5hbmltYXRpb25zLnBsYXkoJ3J1bicsIDEwLCB0cnVlKTtcbiAgICB0aGlzLmJvZHkuYm91bmNlLnNldFRvKDAsIDApO1xuICAgIHRoaXMuYm9keS5zZXRTaXplKDE4LCAxMCwgMywgMjYpO1xuICAgIHRoaXMuYm9keS5tYXhWZWxvY2l0eSA9IG5ldyBQaGFzZXIuUG9pbnQoMTAwMCwgMTAwMCk7XG4gICAgdGhpcy5ib2R5LmNvbGxpZGVXb3JsZEJvdW5kcyA9IHRydWU7XG4gICAgdGhpcy5tYXNzID0gMjtcbn07XG5cblBsYXllci5wcm90b3R5cGUgPSBPYmplY3QuY3JlYXRlKFBoYXNlci5TcHJpdGUucHJvdG90eXBlKTtcblBsYXllci5wcm90b3R5cGUuY29uc3RydWN0b3IgPSBQbGF5ZXI7XG5cbi8qKlxuICogQXV0b21hdGljYWxseSBjYWxsZWQgYnkgV29ybGQudXBkYXRlXG4gKi9cblBsYXllci5wcm90b3R5cGUudXBkYXRlID0gZnVuY3Rpb24gKCkge1xuXG4gICAgLy8gQWRkIHNwZWVkIHRvIHJ1bm5lclxuICAgIGlmICh0aGlzLmJvZHkudmVsb2NpdHkueCA9PSAwKSB7XG4gICAgICAgIHRoaXMuYm9keS52ZWxvY2l0eS55ICs9IDE7XG4gICAgfVxufTtcblxubW9kdWxlLmV4cG9ydHMgPSBQbGF5ZXI7XG4iLCIndXNlIHN0cmljdCc7XG5cbnZhciBnYW1lID0gbmV3IFBoYXNlci5HYW1lKDM2MCwgNjQwLCBQaGFzZXIuQVVUTywgJ2dyYW5ueXNsYWxvbS1nYW1lJyk7XG5cbndpbmRvdy5VdGlscyA9IHJlcXVpcmUoJy4vdXRpbHMnKTtcbndpbmRvdy5wbGF5ZXJTdGF0ZSA9IHtcbiAgICBjdXJyZW50TGV2ZWw6ICdHYW1lJyxcbiAgICBzY29yZXM6W11cbn1cblxuZ2FtZS5zdGF0ZS5hZGQoJ0Jvb3QnLCByZXF1aXJlKCcuL3N0YXRlcy9ib290JykpO1xuZ2FtZS5zdGF0ZS5hZGQoJ1NwbGFzaCcsIHJlcXVpcmUoJy4vc3RhdGVzL3NwbGFzaCcpKTtcbmdhbWUuc3RhdGUuYWRkKCdQcmVsb2FkZXInLCByZXF1aXJlKCcuL3N0YXRlcy9wcmVsb2FkZXInKSk7XG5nYW1lLnN0YXRlLmFkZCgnTWVudScsIHJlcXVpcmUoJy4vc3RhdGVzL21lbnUnKSk7XG5nYW1lLnN0YXRlLmFkZCgnR2FtZScsIHJlcXVpcmUoJy4vc3RhdGVzL2dhbWUnKSk7XG5nYW1lLnN0YXRlLmFkZCgnU2NvcmUnLCByZXF1aXJlKCcuL3N0YXRlcy9zY29yZScpKTtcbmdhbWUuc3RhdGUuYWRkKCdXaW4nLCByZXF1aXJlKCcuL3N0YXRlcy93aW4nKSk7XG5nYW1lLnN0YXRlLmFkZCgnTG9zZScsIHJlcXVpcmUoJy4vc3RhdGVzL2xvc2UnKSk7XG5cbmdhbWUuc3RhdGUuc3RhcnQoJ0Jvb3QnKTtcbiIsInZhciBCb290ID0gZnVuY3Rpb24gKCkge1xufTtcblxubW9kdWxlLmV4cG9ydHMgPSBCb290O1xuXG5Cb290LnByb3RvdHlwZSA9IHtcblxuICAgIHByZWxvYWQ6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdGhpcy5sb2FkLmltYWdlKCdwcmVsb2FkZXInLCAnYXNzZXRzL3ByZWxvYWRlci5naWYnKTtcbiAgICB9LFxuXG4gICAgY3JlYXRlOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHRoaXMuZ2FtZS5pbnB1dC5tYXhQb2ludGVycyA9IDE7XG5cbiAgICAgICAgdGhpcy5nYW1lLnNjYWxlLnNjYWxlTW9kZSA9IFBoYXNlci5TY2FsZU1hbmFnZXIuU0hPV19BTEw7XG5cbiAgICAgICAgdGhpcy5nYW1lLnN0YXRlLnN0YXJ0KCdQcmVsb2FkZXInKTtcbiAgICB9XG59O1xuIiwidmFyIFBsYXllciA9IHJlcXVpcmUoJy4uL2VudGl0aWVzL3BsYXllcicpO1xudmFyIEdyYW1tYSA9IHJlcXVpcmUoJy4uL2VudGl0aWVzL2dyYW1tYScpO1xuXG52YXIgR2FtZSA9IGZ1bmN0aW9uICgpIHtcbiAgICB0aGlzLnJ1bm5lciA9IG51bGw7XG4gICAgdGhpcy5sYW5kID0gbnVsbDtcbiAgICB0aGlzLmdyYW1tYXMgPSBudWxsO1xuICAgIHRoaXMubmV4dEdyYW1tYSA9IDY0MDtcbiAgICB0aGlzLnRpbWVyID0gMDtcbiAgICB0aGlzLnN0YWdlTGVuZ3RoID0gNjAgKiAzMDA7XG59O1xuXG5tb2R1bGUuZXhwb3J0cyA9IEdhbWU7XG5cbkdhbWUucHJvdG90eXBlID0ge1xuXG4gICAgY3JlYXRlOiBmdW5jdGlvbiAoKSB7XG5cbiAgICAgICAgdGhpcy53b3JsZC5zZXRCb3VuZHMoMCwgMCwgMzYwLCB0aGlzLnN0YWdlTGVuZ3RoKTtcblxuICAgICAgICB0aGlzLnBoeXNpY3Muc3RhcnRTeXN0ZW0oUGhhc2VyLlBoeXNpY3MuQVJDQURFKTtcblxuICAgICAgICB0aGlzLmxhbmQgPSB0aGlzLmFkZC50aWxlU3ByaXRlKDAsIDAsIDM2MCwgNjQwLCAnZmxvb3J0aWxlJyk7XG4gICAgICAgIHRoaXMubGFuZC5zY2FsZS5zZXQoMik7XG4gICAgICAgIHRoaXMubGFuZC5zbW9vdGhlZCA9IGZhbHNlO1xuICAgICAgICB0aGlzLmxhbmQuZml4ZWRUb0NhbWVyYSA9IHRydWU7XG5cbiAgICAgICAgdGhpcy5ydW5uZXIgPSBuZXcgUGxheWVyKHRoaXMuZ2FtZSwgMzYwLzIsIDIwMCk7XG4gICAgICAgIHRoaXMuZ3JhbW1hcyA9IHRoaXMuYWRkLmdyb3VwKCk7XG5cbiAgICAgICAgdGhpcy5jYW1lcmEuZm9sbG93KHRoaXMucnVubmVyKTtcblxuICAgICAgICB0aGlzLnRpbWUuZXZlbnRzLmFkZChQaGFzZXIuVGltZXIuU0VDT05EICogNjAsIHRoaXMuZW5kR2FtZSwgdGhpcyk7XG5cbiAgICAgICAgdGhpcy50aW1lciA9IHRoaXMuZ2FtZS5hZGQudGV4dCh0aGlzLndvcmxkLmNlbnRlclgsIDAsIFwiNjBcIik7XG4gICAgICAgIHRoaXMudGltZXIuZml4ZWRUb0NhbWVyYSA9IHRydWU7XG4gICAgICAgIHRoaXMudGltZXIuYW5jaG9yLnNldCgwLjUsIDApO1xuICAgIH0sXG5cbiAgICB1cGRhdGU6IGZ1bmN0aW9uICgpIHtcblxuICAgICAgICB2YXIgdGltZUxlZnQgPSBNYXRoLmZsb29yKHRoaXMudGltZS5ldmVudHMuZHVyYXRpb24gLyAxMDAwKTtcbiAgICAgICAgdmFyIGRpc3RhbmNlTGVmdCA9IHRoaXMuc3RhZ2VMZW5ndGggLSB0aGlzLmNhbWVyYS55IC0gNjQwO1xuXG4gICAgICAgIHRoaXMudGltZXIuc2V0VGV4dCh0aW1lTGVmdCArICcgfHwgJyArIGRpc3RhbmNlTGVmdCk7XG5cbiAgICAgICAgdGhpcy5waHlzaWNzLmFyY2FkZS5jb2xsaWRlKHRoaXMucnVubmVyLCB0aGlzLmdyYW1tYXMpO1xuXG4gICAgICAgIHRoaXMucnVubmVyLmJvZHkudmVsb2NpdHkueCA9IDA7XG5cbiAgICAgICAgLy8gS2V5IHByZXNzIHRvIHJpZ2h0XG4gICAgICAgIGlmICh0aGlzLmlucHV0LmtleWJvYXJkLmlzRG93bihQaGFzZXIuS2V5Ym9hcmQuUklHSFQpKSB7XG4gICAgICAgICAgICB0aGlzLnJ1bm5lci5ib2R5LnZlbG9jaXR5LnggPSArIDMwMDtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIEtleSBwcmVzcyB0byBsZWZ0XG4gICAgICAgIGlmICh0aGlzLmlucHV0LmtleWJvYXJkLmlzRG93bihQaGFzZXIuS2V5Ym9hcmQuTEVGVCkpIHtcbiAgICAgICAgICAgIHRoaXMucnVubmVyLmJvZHkudmVsb2NpdHkueCA9IC0gMzAwO1xuICAgICAgICB9XG5cblxuICAgICAgICAvLyB0aGUgYW1tb3VudCBpcyBoYWx2ZWQgZHVlIHRvIHNjYWxpbmdcbiAgICAgICAgdGhpcy5sYW5kLnRpbGVQb3NpdGlvbi54ID0gLXRoaXMuY2FtZXJhLnggLyAyO1xuICAgICAgICB0aGlzLmxhbmQudGlsZVBvc2l0aW9uLnkgPSAtdGhpcy5jYW1lcmEueSAvIDI7XG5cbiAgICAgICAgaWYgKHRoaXMuY2FtZXJhLnkgPiB0aGlzLm5leHRHcmFtbWEpIHtcbiAgICAgICAgICAgIHRoaXMuYWRkR3JhbW1hKCk7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAoZGlzdGFuY2VMZWZ0ID09IDApIHtcbiAgICAgICAgICAgIHRoaXMuZW5kR2FtZSh0cnVlKTtcbiAgICAgICAgfVxuICAgIH0sXG5cbiAgICByZW5kZXI6IGZ1bmN0aW9uICgpIHtcblxuICAgICAgICAvLyB0aGlzLmdhbWUuZGVidWcuYm9keUluZm8odGhpcy5ydW5uZXIsIDMyLCAzMik7XG4gICAgICAgIC8vIHRoaXMuZ2FtZS5kZWJ1Zy5ib2R5KHRoaXMucnVubmVyLCAzMiwgMzIpO1xuXG4gICAgfSxcblxuICAgIGFkZEdyYW1tYTogZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgZ3JhbW1hID0gbmV3IEdyYW1tYShcbiAgICAgICAgICAgIHRoaXMuZ2FtZSxcbiAgICAgICAgICAgIHRoaXMucnVubmVyLnggKyAoOTAgLSAoTWF0aC5yYW5kb20oKSAqIDE4MCkpLFxuICAgICAgICAgICAgdGhpcy5jYW1lcmEueSArIDY0MFxuICAgICAgICApO1xuXG4gICAgICAgIC8vIHRoaXMuZ2FtZS5kZWJ1Zy5ib2R5KGdyYW1tYSk7XG4gICAgICAgIHRoaXMuZ3JhbW1hcy5hZGQoZ3JhbW1hKTtcbiAgICAgICAgdGhpcy5uZXh0R3JhbW1hKz0gNjQwO1xuICAgIH0sXG5cbiAgICBvdXRCb3VuZHM6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgY29uc29sZS5sb2coJ291dCcpO1xuICAgICAgICAvLyB0aGlzLmVuZEdhbWUodHJ1ZSlcbiAgICB9LFxuXG4gICAgZW5kR2FtZTogZnVuY3Rpb24gKHdpbikge1xuICAgICAgICB2YXIgc2NvcmUgPSAwO1xuXG4gICAgICAgIGlmICh3aW4pIHtcbiAgICAgICAgICAgIHRoaXMuZ2FtZS5zdGF0ZS5zdGFydCgnV2luJyk7XG4gICAgICAgICAgICBzY29yZSA9IHRoaXMudGltZS5ldmVudHMuZHVyYXRpb247XG4gICAgICAgICAgICB3aW5kb3cucGxheWVyU3RhdGUuc2NvcmVzLnB1c2goc2NvcmUpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgdGhpcy5nYW1lLnN0YXRlLnN0YXJ0KCdMb3NlJyk7XG4gICAgICAgIH1cbiAgICB9XG59O1xuIiwidmFyIExvc2UgPSBmdW5jdGlvbiAoKSB7XG59O1xuXG5tb2R1bGUuZXhwb3J0cyA9IExvc2U7XG5cbkxvc2UucHJvdG90eXBlID0ge1xuICAgIGNyZWF0ZTogZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgc3R5bGUgPSB7Zm9udDogXCIyNHB4IEFyaWFsXCIsIGZpbGw6IFwiI2ZmZmZmZlwiLCBhbGlnbjogXCJjZW50ZXJcIn0sXG4gICAgICAgICAgICB0ZXh0ID0gdGhpcy5hZGQudGV4dCh0aGlzLndvcmxkLmNlbnRlclgsIDIwMCwgXCJZb3UgTG9zZVwiLCBzdHlsZSk7XG5cbiAgICAgICAgdGV4dC5hbmNob3Iuc2V0KDAuNSwgMCk7XG5cbiAgICAgICAgdGhpcy5pbnB1dC5vbkRvd24uYWRkKHRoaXMub25Eb3duLCB0aGlzKTtcbiAgICB9LFxuXG4gICAgb25Eb3duOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHRoaXMuZ2FtZS5zdGF0ZS5zdGFydCgnTWVudScpO1xuICAgIH1cbn07IiwidmFyIE1lbnUgPSBmdW5jdGlvbiAoKSB7XG4gICAgdGhpcy50ZXh0ID0gbnVsbDtcbn07XG5cbm1vZHVsZS5leHBvcnRzID0gTWVudTtcblxuTWVudS5wcm90b3R5cGUgPSB7XG5cbiAgICBjcmVhdGU6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIHN0eWxlID0ge2ZvbnQ6IFwiMjRweCBBcmlhbFwiLCBmaWxsOiBcIiNmZmZmZmZcIiwgYWxpZ246IFwiY2VudGVyXCJ9LFxuICAgICAgICAgICAgdGV4dCA9IHRoaXMuYWRkLnRleHQodGhpcy53b3JsZC5jZW50ZXJYLCAyMDAsIFwiUHJlc3MgdG8gU3RhcnRcIiwgc3R5bGUpO1xuXG4gICAgICAgIHRoaXMuc3RhZ2UuYmFja2dyb3VuZENvbG9yID0gXCIjMDAwMDAwXCI7XG5cbiAgICAgICAgdGV4dC5hbmNob3Iuc2V0KDAuNSwgMCk7XG5cbiAgICAgICAgdGhpcy5pbnB1dC5vbkRvd24uYWRkKHRoaXMub25Eb3duLCB0aGlzKTtcbiAgICB9LFxuXG4gICAgdXBkYXRlOiBmdW5jdGlvbiAoKSB7XG4gICAgfSxcblxuICAgIG9uRG93bjogZnVuY3Rpb24gKCkge1xuICAgICAgICB0aGlzLmdhbWUuc3RhdGUuc3RhcnQocGxheWVyU3RhdGUuY3VycmVudExldmVsKTtcbiAgICAgICAgLy8gdGhpcy5nYW1lLnN0YXRlLnN0YXJ0KCdXaW4nKTtcbiAgICB9XG59O1xuIiwidmFyIFByZWxvYWRlciA9IGZ1bmN0aW9uIChnYW1lKSB7XG4gICAgdGhpcy5hc3NldCA9IG51bGw7XG4gICAgdGhpcy5yZWFkeSA9IGZhbHNlO1xufTtcblxubW9kdWxlLmV4cG9ydHMgPSBQcmVsb2FkZXI7XG5cblByZWxvYWRlci5wcm90b3R5cGUgPSB7XG5cbiAgICBwcmVsb2FkOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHRoaXMuYXNzZXQgPSB0aGlzLmFkZC5zcHJpdGUoMzIwLCAyNDAsICdwcmVsb2FkZXInKTtcbiAgICAgICAgdGhpcy5hc3NldC5hbmNob3Iuc2V0VG8oMC41LCAwLjUpO1xuXG4gICAgICAgIHRoaXMubG9hZC5vbkxvYWRDb21wbGV0ZS5hZGRPbmNlKHRoaXMub25Mb2FkQ29tcGxldGUsIHRoaXMpO1xuICAgICAgICB0aGlzLmxvYWQuc2V0UHJlbG9hZFNwcml0ZSh0aGlzLmFzc2V0KTtcbiAgICAgICAgdGhpcy5sb2FkLmltYWdlKCdmbG9vcnRpbGUnLCAnYXNzZXRzL2Zsb29ydGlsZS5wbmcnKTtcbiAgICAgICAgdGhpcy5sb2FkLnNwcml0ZXNoZWV0KCdydW5uZXInLCAnYXNzZXRzL3J1bm5lci5wbmcnLCAzNiwgMzYpO1xuICAgICAgICB0aGlzLmxvYWQuc3ByaXRlc2hlZXQoJ2dyYW1tYScsICdhc3NldHMvZ3JhbW1hLnBuZycsIDM2LCAzNik7XG5cbiAgICB9LFxuXG4gICAgY3JlYXRlOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHRoaXMuYXNzZXQuY3JvcEVuYWJsZWQgPSBmYWxzZTtcbiAgICB9LFxuXG4gICAgdXBkYXRlOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGlmICghIXRoaXMucmVhZHkpIHtcbiAgICAgICAgICAgIHRoaXMuZ2FtZS5zdGF0ZS5zdGFydCgnTWVudScpO1xuICAgICAgICB9XG4gICAgfSxcblxuICAgIG9uTG9hZENvbXBsZXRlOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHRoaXMucmVhZHkgPSB0cnVlO1xuICAgIH1cbn07XG4iLCJ2YXIgU2NvcmUgPSBmdW5jdGlvbiAoKSB7XG59O1xuXG5tb2R1bGUuZXhwb3J0cyA9IFNjb3JlO1xuXG5TY29yZS5wcm90b3R5cGUgPSB7XG4gICAgY3JlYXRlOiBmdW5jdGlvbiAoKSB7XG5cbiAgICB9XG59OyIsInZhciBTcGxhc2ggPSBmdW5jdGlvbiAoKSB7XG59O1xuXG5tb2R1bGUuZXhwb3J0cyA9IFNwbGFzaDtcblxuU3BsYXNoLnByb3RvdHlwZSA9IHtcbiAgICBjcmVhdGU6IGZ1bmN0aW9uICgpIHtcbiAgICB9XG59OyIsInZhciBXaW4gPSBmdW5jdGlvbiAoKSB7XG59O1xuXG5tb2R1bGUuZXhwb3J0cyA9IFdpbjtcblxuV2luLnByb3RvdHlwZSA9IHtcbiAgICBjcmVhdGU6IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIGxhc3RTY29yZSA9IHdpbmRvdy5wbGF5ZXJTdGF0ZS5zY29yZXNbd2luZG93LnBsYXllclN0YXRlLnNjb3Jlcy5sZW5ndGgtMV0sXG4gICAgICAgICAgICBzdHlsZSA9IHtmb250OiBcIjI0cHggQXJpYWxcIiwgZmlsbDogXCIjZmZmZmZmXCIsIGFsaWduOiBcImNlbnRlclwifSxcbiAgICAgICAgICAgIHRleHQgPSB0aGlzLmFkZC50ZXh0KHRoaXMud29ybGQuY2VudGVyWCwgMjAwLCBcIllvdSB3aW4gXCIgKyBsYXN0U2NvcmUsIHN0eWxlKTtcblxuICAgICAgICB0ZXh0LmFuY2hvci5zZXQoMC41LCAwKTtcblxuICAgICAgICB0aGlzLmlucHV0Lm9uRG93bi5hZGQodGhpcy5vbkRvd24sIHRoaXMpO1xuICAgIH0sXG5cbiAgICBvbkRvd246IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdGhpcy5nYW1lLnN0YXRlLnN0YXJ0KCdNZW51Jyk7XG4gICAgfVxufTsiLCJ2YXIgVXRpbHMgPSB7XG4gICAgY29udGFpbnNPYmplY3Q6IGZ1bmN0aW9uIChvYmosIGxpc3QpIHtcbiAgICAgICAgdmFyIGk7XG4gICAgICAgIGZvciAoaSA9IDA7IGkgPCBsaXN0Lmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICBpZiAobGlzdFtpXSA9PT0gb2JqKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxufTtcblxubW9kdWxlLmV4cG9ydHMgPSBVdGlsczsiXX0=
